---
title: "Evolution de la temp√©rature en france"
format: html
editor: visual
author: "VARON,DIAKITE"
---

```{r echo=FALSE, warning=FALSE, message=FALSE }
library(readr)
library(xts)
library(readxl)
library(astsa)
library(ggfortify)
library(forecast)
library(fpp2)
library(seasonal)
library(tseries)
library(TTR)
library(urca)
library(dplyr)
library(lubridate)
library(writexl)
library(prophet)
library(ggplot2)
```

Sous PBI

-   serie initial

-   autocor/autocov(recuperer un valeur ACF) + autocov partiel

-   desaissonalisation : cvs ( 1er methode : 1 serie csv (moyenne mobile))

-   decommposition un serie : s + tendance ( focntion de decompositon de R)

-   prevision : lissage exponentiel ( holt winter) + comparaison avec l'outil auto de PBI

-   Annexe(PROPHETE - facebook-R)

-   Rendu final(PBI) . R comment√©

# 1) Importation des donn√©es et traitement des valeurs manquantes

Ce projet est consacr√© √† l‚Äô√©tude de l‚Äô√©volution des temp√©ratures en France entre 1970 et 2013, avec l‚Äôobjectif de d√©tecter d‚Äô√©ventuels signes de r√©chauffement climatique. √Ä travers cette analyse, nous cherchons √† mieux comprendre comment les temp√©ratures ont √©volu√© au fil du temps et si ces changements sugg√®rent une tendance √† un r√©chauffement futur. Pour cela, nous utilisons des mod√®les de s√©ries temporelles comme Holt-Winters , Prophet(facebook), etc afin de saisir les variations mensuelles des temp√©ratures. En explorant ces donn√©es, nous esp√©rons non seulement identifier des tendances g√©n√©rales, mais aussi observer les fluctuations saisonni√®res et leurs √©ventuelles cons√©quences. L‚Äôid√©e est de poser un regard sur les tendances pass√©es pour imaginer les d√©fis climatiques de demain.

```{r echo=FALSE, warning=FALSE, message=FALSE}

# Chargement des donn√©es
fich <- read.csv("donneetemp.csv", header = TRUE)

# S√©lectionn des colonnes d'int√©r√™t
fich <- fich[, 1:2]
colnames(fich) <- c("Dates", "Temperature")
sum(is.na(fich))
# Suppression de valeurs manquantes
fich <- na.omit(fich)

# Convertir en format Date
fich$Dates <- as.Date(fich$Dates)

# Transformer en s√©rie temporelle avec xts
fich_xts <- xts(fich$Temperature, order.by = fich$Dates)
summary(fich_xts)
boxplot(fich_xts, main = "Boxplot des Temp√©ratures")  
```

Notre jeu de donn√©es ne contient pas de valeurs manquantes, et le boxplot ne montre aucune valeur aberrante. En observant le boxplot, on remarque que la moyenne des temp√©ratures se situe autour de 11¬∞C, ce qui confirme une tendance relativement stable des temp√©ratures sur la p√©riode analys√©e.

# 2)Distribution des donn√©es

```{r echo=FALSE, warning=FALSE, message=FALSE}
 # look at the description of the series
plot(fich_xts)

# a) Depict the histogram of "elecequip". Set the number of class to 20 in "breaks" option.
hist(fich_xts, 
     breaks = 20, # number of class
     main = "temperature  Jan. 1970 to Aout. 2013",
     xlab = "")

# b) Depict the kernel density of "elecequip".
plot(density(fich_xts))

# c) Plot the histogram and the kernel density of"temp" along with normal distribution
hist(fich_xts, breaks=20, probability = TRUE, main = "temp", xlab = "")
curve(dnorm(x, mean=mean(fich), sd=sd(fich_xts)), col="darkblue", lwd=2, add=TRUE, yaxt="n")
lines(density(fich_xts), lwd = 2, col = "red")

# d) Depict the Boxplot of "temp".
boxplot(fich_xts, horizontal = TRUE, main = "temp")

# e) Depict the QQ-plot "temp" for normality test.
qqnorm(fich_xts, main = "temp")
qqline(fich_xts, col = "red")

```

L‚Äôhistogramme de la temp√©rature met en √©vidence plusieurs √©l√©ments importants :

La distribution ne semble pas strictement normale (gaussienne).

On observe deux zones de forte densit√© : une entre 4¬∞C et 14¬∞C, une autre entre 15¬∞C et 22¬∞C.

Cela sugg√®re la pr√©sence de deux r√©gimes thermiques ‚Äî possiblement li√©s aux saisons de transition (printemps/automne) et √† l‚Äô√©t√©.

Extr√™mes peu fr√©quents :

Les temp√©ratures inf√©rieures √† 0¬∞C (hiver rigoureux) ainsi que sup√©rieures √† 22¬∞C (p√©riodes de chaleur intense) sont beaucoup plus rares.

Ces valeurs extr√™mes apparaissent comme des queues de distribution et renforcent l‚Äôid√©e d‚Äôun climat mod√©r√©.

Hypoth√®se d‚Äôun m√©lange de lois normales :

La forme globale pourrait √™tre approch√©e par un m√©lange de deux lois normales (gaussiennes), ce qui est typique dans les s√©ries m√©t√©orologiques comprenant des cycles saisonniers.

# 3)Analyse de la s√©rie

```{r echo=FALSE, warning=FALSE, message=FALSE}

plot(fich_xts, main = "√âvolution de la Temp√©rature Moyenne", col = "blue", 
     ylab = "Temp√©rature (¬∞C)", xlab = "Ann√©e")
```

Graphiquement, on remarque une saisonnalit√© annuelle marqu√©e, mais des tests suppl√©mentaires sont n√©cessaires pour confirmer la tendance, qui semble soit invisible, soit inexistante.

## a) ACF/PACF

```{r echo=FALSE, warning=FALSE, message=FALSE}
#a) Depict the autocorrelation function of "elecequip" using acf().
acf(fich_xts, main = "FA of temp√©rature")

# b) Depict the partial autocorrelation function of "elecequip" using pacf().
pacf(fich_xts, main = "FAP temp")

# c) Use acf2() from astsa to plot the sample P/ACF pair for the generated data x. Comment.
acf2(fich_xts)


```

Les pics alternants entre valeurs positives et n√©gatives dans l'ACF indiquent une saisonnalit√© marqu√©e. On remarque une autocorr√©lation persistante sur plusieurs lags, en particulier aux lags 1, 2, 12, 24, etc. Quant au PACF, il chute brusquement apr√®s le lag 4, ce qui sugg√®re un mod√®le MA(4).

```{r echo=FALSE, warning=FALSE, message=FALSE}
moving_avg <- rollmean(fich_xts, k = 12, fill = NA)
summary(moving_avg)
plot(fich_xts, main = "Temp√©rature Moyenne avec Tendance", col = "blue")
lines(moving_avg, col = "red", lwd = 2) # Ajout de la tendance

```

D'apr√®s la moyenne mobile en rouge, qui tourne autour de 11¬∞C et reste constante au fil du temps, il n'y a pas de tendance apparente. Cette observation est confirm√©e par la d√©composition de la s√©rie.

## b)D√©compostion de la s√©rie

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Convertir la s√©rie en un objet ts avec une fr√©quence annuelle (12 mois)
fich_ts <- ts(fich_xts, frequency = 12)

# D√©composition additive
decomposed <- decompose(fich_ts, type = "additive")

# Affichage des composants
plot(decomposed)

decomposed_mult <- decompose(fich_ts, type = "multiplicative")
plot(decomposed_mult)
```

Ces deux graphiques repr√©sentent la d√©composition additive et multiplicative de la s√©rie. Dans la d√©composition additive, en tra√ßant la moyenne mobile, nous remarquons qu'elle est presque constante (autour de 11¬∞C), ce qui confirme l'absence de tendance. En revanche, on observe une forte saisonnalit√© annuelle. Les graphiques des r√©sidus sont al√©atoires, ce qui confirme que la s√©rie suit un mod√®le additive.

Concernant la d√©composition multiplicative, les r√©sidus ne semblent pas √™tre al√©atoires, ce qui renforce l'hypoth√®se que notre s√©rie est bien additive. √âtant additive, une transformation de Box-Cox n'aura pas d'impact significatif. Nous verrons d'ailleurs qu'apr√®s avoir appliqu√© une transformation logarithmique, la s√©rie reste inchang√©e.

```{r echo=FALSE, warning=FALSE, message=FALSE}
autoplot(fich_xts)


fich_xts %>% BoxCox(lambda = 0) %>% autoplot() # egale autoplot(log(fich))
fich_xts %>% BoxCox(lambda = 0.1) %>% autoplot()
fich_xts %>% BoxCox(lambda = 0.2) %>% autoplot()
fich_xts %>% BoxCox(lambda = 0.3) %>% autoplot()

# c) Now compare your chosen value of lambda with the one returned by BoxCox.lambda()
BoxCox.lambda(fich_xts)
```

Le meilleur lambda √©tant 0,95, presque √©gal √† 1, il n'y a pas de changement significatif apr√®s la transformation, ce qui confirme que la s√©rie est additive.\

```{r echo=FALSE, warning=FALSE, message=FALSE}
fich_ts <- ts(fich_xts, frequency = 12)  

seas_test <- nsdiffs(fich_ts)  # Nombre de diff√©renciations saisonni√®res n√©cessaires
seas_test


```

Le nombre de diff√©renciations saisonni√®res n√©cessaire est √©gal √† 1, ce qui indique qu'une seule diff√©renciation suffit pour √©liminer la composante saisonni√®re.\

## c) d√©saisonnalisation avec moyenne mobile

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Composante saisonni√®re (brute)
saisonnalite <- fich_xts - moving_avg
plot(moving_avg)
plot(saisonnalite)
# Extraire le mois de chaque observation

mois <- month(index(fich_xts))
# Moyenne de la saisonnalit√© pour chaque mois
saison_moy <- tapply(saisonnalite, mois, mean, na.rm = TRUE)

# Associer √† chaque observation
coef_saisonnier <- saison_moy[as.character(mois)]

coef_saisonnier_xts <- xts(coef_saisonnier, order.by = index(fich_xts))
# D√©saisonnalisation (mod√®le additif)
desaisonnalis√©e <- fich_xts - coef_saisonnier_xts

# Tracer
plot(desaisonnalis√©e , col= "red")
plot(fich_xts, main = "S√©rie originale vs d√©saisonnalis√©e", col = "black")
lines(desaisonnalis√©e, col = "blue")

```

Le graphique en rouge repr√©sente la s√©rie d√©saisonnalis√©e, o√π les temp√©ratures varient entre 5¬∞C et 16¬∞C apr√®s √©limination de la saisonnalit√©.

## d) diff√©renciation saisonni√©re

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Diff√©renciation saisonni√®re pour une saisonnalit√© annuelle (p√©riode 12)
fich_xts_seasonal_diff <- diff(fich_xts, lag = 12)

summary(fich_xts_seasonal_diff)
fich_ts <- ts(fich_xts_seasonal_diff, frequency = 12)  
seas_test <- nsdiffs(fich_ts)  
seas_test


plot(fich_xts_seasonal_diff)
#adf.test(na.omit(fich_xts_seasonal_diff))

```

Nous observons que la composante saisonni√®re a √©t√© √©limin√©e et que le nombre de diff√©renciations n√©cessaires est √©gal √† 0, ce qui indique que la s√©rie a √©t√© correctement diff√©renci√©e.

## e) D√©composition de la s√©rie diff√©renci√©e

```{r echo=FALSE, warning=FALSE, message=FALSE}
fich_ts <- ts(fich_xts_seasonal_diff, frequency = 12)

# D√©composition additive
decomposed <- decompose(fich_ts, type = "additive")

# Affichage des composants
plot(decomposed)

decomposed_mult <- decompose(fich_ts, type = "multiplicative")
plot(decomposed_mult)
```

Avec la d√©composition de la s√©rie diff√©renci√©e, nous remarquons que la saisonnalit√© a disparu et qu'il n'y a plus de tendance. Nous allons maintenant v√©rifier la stationnarit√© de la s√©rie √† l'aide des tests de racine unitaire.

## f) ACF/PACF de la s√©rie diff√©renci√©e

## 

```{r echo=FALSE, warning=FALSE, message=FALSE}
#a) Depict the autocorrelation function of "elecequip" using acf().
acf(na.omit(fich_xts_seasonal_diff, main = "FA of temp√©rature"))

# b) Depict the partial autocorrelation function of "elecequip" using pacf().
pacf(na.omit(fich_xts_seasonal_diff, main = "FAP temp"))

# c) Use acf2() from astsa to plot the sample P/ACF pair for the generated data x. Comment.
acf2(na.omit(fich_xts_seasonal_diff))
```

Avec le correlogramme et pacf de la s√©rie differencie , il n'a plus de saisonnalit√© et et ont voit que claire qu'avec cette serie , le PACF nous montre que seul le lag12 est significatif , typique d'un MA(1)

## h) test de Dickey-Fuller augment√©

```{r echo=FALSE, warning=FALSE, message=FALSE}
# Effectuer le test de Dickey-Fuller augment√©
#adf_test <- adf.test(na.omit(fich_xts_seasonal_diff))
#adf_test
adf_test1 <- adf.test(na.omit(fich_xts))
adf_test1
```

La p-value √©tant inf√©rieure √† 5 %, la s√©rie est consid√©r√©e comme stationnaire et nous rejetons donc l'hypoth√®se nulle. Cependant, nous allons confirmer cela en utilisant les tests unitaires.

### hh) Test de Racine Unitaire

```{r echo=FALSE, warning=FALSE, message=FALSE}
# a) Proceed to the ADF unit root test for "lop". Choose 5% significance level to make your decision
#test_none <- ur.df(na.omit(fich_xts), type = "none", lags = 12)
#summary(test_none)
summary(ur.df(na.omit(fich_xts), type = "trend", lags = 12, selectlags="AIC")) #avec aic on lui laisse le 

```

```         
tt = 2.547 < 2.79, donc il n'est pas n√©cessaire de r√©aliser un test de racine unitaire. La tendance n'est pas significative, et nous passons au mod√®le 2.
```

```{r echo=FALSE, warning=FALSE, message=FALSE}
summary(ur.df(fich_xts, type = "drift", lags = 12, selectlags="AIC"))
```

```         
On se concentre sur la constante, qui est √©gale √† 3.500, et qui est sup√©rieure √† 3.11. La constante est donc significative. Nous proc√©dons maintenant au test de la racine unitaire.
```

D'apr√®s la sortie R, le test de la statistique de test donne une valeur de -3,49, qui est inf√©rieure √† -2,86. Cela signifie qu'il n'est pas n√©cessaire de faire une diff√©renciation, car il n'y a pas de racine unitaire. Notre mod√®le est d√©j√† stationnaire.

```{r echo=FALSE, warning=FALSE, message=FALSE}
test_perron <- ur.za(fich_xts, model = "both", lag = 12)
summary(test_perron)
test_adf <- ur.df(na.omit(fich_xts, type = "drift", lags = 12))
summary(test_adf)


```

Nous avons appliqu√© le test de Zivot-Andrews afin de d√©tecter une √©ventuelle stationnarit√© de la s√©rie en pr√©sence d‚Äôune rupture structurelle endog√®ne, c‚Äôest-√†-dire sans sp√©cifier a priori la date de changement.

Statistique du test observ√©e : ‚àí5.159

Au seuil de 1 % : ‚àí5.57\
Au seuil de 5 % : ‚àí5.08\
Au seuil de 10 % : ‚àí4.82

La statistique observ√©e (‚àí5.1593) est inf√©rieure √† la valeur critique de 5 % (‚àí5.08), ce qui permet de rejeter l‚Äôhypoth√®se nulle de racine unitaire. La s√©rie est donc stationnaire √† un seuil de confiance de 95 %, en tenant compte d‚Äôune rupture structurelle.

En conclusion, d'apr√®s les diff√©rents tests, notre s√©rie est stationnaire en moyenne et en variance. Nous pouvons donc appliquer diff√©rents mod√®les de pr√©dictions comme ARIMA.

# 4) Prevision ARIMA

```{r echo=FALSE, warning=FALSE, message=FALSE}
# modele ARIMA
fich_xts %>% Arima(order = c(4, 0, 1)) %>% forecast(h=10*12) %>% autoplot()

mod_arima <- auto.arima(fich_xts)
summary(mod_arima)

#mod = auto.arima(na.omit(fich_xts_seasonal_diff ))
#summary(mod)
forecast_arima <- forecast(mod_arima , h = 10*12)
autoplot(forecast_arima)

```

\
Le mod√®le ajust√© est un ARIMA(4,0,1) avec moyenne non nulle. Tous les coefficients AR (ar1 √† ar4) et MA (ma1) sont significatifs (petites erreurs standards par rapport aux valeurs des coefficients). La variance r√©siduelle est de 3.214, et l'AIC est relativement bas (2111.68), ce qui indique un mod√®le assez performant.

Concernant les erreurs d'ajustement sur l'√©chantillon d'apprentissage, le biais moyen (ME) est presque nul (-0.0045), ce qui montre que le mod√®le ne pr√©sente pas de biais syst√©matique. Les erreurs globales (RMSE = 1.78, MAE = 1.41) restent mod√©r√©es. Le MAPE (\~24 %) montre une erreur moyenne relative raisonnable. De plus, l'ACF du r√©sidu au premier d√©calage (-0.017) est tr√®s proche de z√©ro, sugg√©rant peu d'autocorr√©lation r√©siduelle.

**En r√©sum√©**, le mod√®le est globalement bien ajust√©, sans biais marqu√© et avec des erreurs acceptables pour la s√©rie temporelle consid√©r√©e.

```{r echo=FALSE, warning=FALSE, message=FALSE}
checkresiduals(forecast_arima)

```

```{r echo=FALSE, warning=FALSE, message=FALSE}
test_adf <- ur.df(residuals(forecast_arima), type = "drift", lags = 12)
summary(test_adf)

```

Bien que le test ADF appliqu√© aux r√©sidus confirme leur stationnarit√©, le test de Ljung-Box r√©v√®le une autocorr√©lation r√©siduelle significative. Cela sugg√®re que le mod√®le ARIMA(4,0,1) n'a pas totalement captur√© la structure d√©pendante de la s√©rie. Il serait pertinent d'envisager des mod√®les plus complexes ou d'ajuster les ordres pour am√©liorer l'ajustement.

# 5) lissage exponentiel(Holt Winter)

```{r echo=FALSE, warning=FALSE, message=FALSE}
# üîπ V√©rifier que la s√©rie a une fr√©quence mensuelle
fich_xts <- ts(fich_xts, frequency = 12)

# üîπ Lissage exponentiel de Holt-Winters (additif si saisonnalit√© constante)
modele_hw <- hw(fich_xts, seasonal = "additive", h = 120)
summary(modele_hw)
checkresiduals(modele_hw)
# üîπ Tracer la pr√©vision
autoplot(modele_hw)

start_date <- as.Date("2013-09-01")

# üîπ G√©n√©rer la s√©quence de dates pour les pr√©visions
dates_forecast <- seq.Date(from = start_date, by = "month", length.out = 120)
# üîπ Cr√©ation du DataFrame avec les pr√©visions
df_pred <- data.frame(
  Date = dates_forecast,
  Temp√©rature_Observ√©e = NA,
  Moy_Mobile = NA,
  Pr√©vision = as.numeric(modele_hw$mean),
  IC_min = as.numeric(modele_hw$lower[,2]),
  IC_max = as.numeric(modele_hw$upper[,2])
)


# üîπ Donn√©es historiques
df_hist <- data.frame(
  Date = as.Date((fich$Dates)),
  Temp√©rature_Observ√©e = as.numeric(fich_xts),
  Moy_Mobile = as.numeric(zoo::rollmean(fich_xts, k = 12, fill = NA)),
  Pr√©vision = NA,
  IC_min = NA,
  IC_max = NA
)
#tail(df_hist$Date)
#head(df_pred$Date)
# üîπ Fusion
df_final <- bind_rows(df_hist, df_pred)
#df_final
# üîπ Sauvegarde pour Power BI
write_csv(df_final, "previsions_powerbi_holtwinters.csv" )
write_xlsx(df_final, "previsions_powerbi_holtwinters.xlsx")



```

Nous avons utilis√© le mod√®le **Holt-Winters additif** pour pr√©voir les temp√©ratures mensuelles de 2013 √† 2023. Ce mod√®le, qui prend en compte le **niveau**, la **tendance** et la **saisonnalit√©** des donn√©es, nous a permis de capturer efficacement l‚Äôeffet saisonnier bien marqu√© des temp√©ratures.\
Les param√®tres de lissage (alpha ‚âà 0.0004, beta ‚âà 0.0004, gamma ‚âà 0.0011) sont tr√®s faibles, ce qui indique une grande **stabilit√© du mod√®le** et une **faible r√©activit√© aux variations** de court terme. Le niveau initial est estim√© √† **10,44¬∞C**, avec une tendance l√©g√®rement n√©gative (**-0,0043¬∞C/mois**), traduisant une tr√®s l√©g√®re baisse des temp√©ratures sur la p√©riode. L'effet saisonnier met en √©vidence des hivers significativement plus froids et des √©t√©s plus chauds.

Les performances d'ajustement sont correctes, avec un **RMSE** de **1,4¬∞C**, un **MAE** de **1,1¬∞C** et un **MAPE** d‚Äôenviron **20 %**, ce qui montre que le mod√®le pr√©sente des erreurs de pr√©vision raisonnables. Le **MASE** inf√©rieur √† 1 confirme que le mod√®le est **plus performant qu'une pr√©vision na√Øve**. De plus, un **ACF1 faible** (‚âà 0,14) sugg√®re une faible autocorr√©lation des erreurs, renfor√ßant la cr√©dibilit√© du mod√®le.

L'analyse des r√©sidus r√©v√®le qu'ils sont **centr√©s autour de z√©ro**, sans tendance syst√©matique et avec une **variance relativement constante**. L'histogramme des r√©sidus sugg√®re une distribution **proche de la normale**. Surtout, le **test de Ljung-Box** appliqu√© aux r√©sidus fournit une **p-value de 0,2519**, ce qui indique **l'absence d'autocorr√©lation significative** et valide les hypoth√®ses classiques sur les erreurs.

En conclusion, **le mod√®le Holt-Winters additif est bien ajust√©** aux donn√©es et constitue un outil fiable pour pr√©voir les temp√©ratures futures avec un niveau d‚Äôerreur acceptable.

# 6) comparaison Arima et Holt Winter

En conclusion, bien que le mod√®le **ARIMA(4,0,1)** pr√©sente des crit√®res d'ajustement plus favorables avec des AIC et BIC plus bas (AIC = 2111.68), il ne parvient pas √† capturer correctement la structure temporelle des donn√©es, comme l'indique le test de Ljung-Box avec un p-value tr√®s faible (3.553e-15). D'autre part, le mod√®le **Holt-Winters additive** montre de meilleures performances sur les erreurs d'entra√Ænement avec un RMSE de 1.396 et une MAPE de 20.41549, tout en pr√©sentant des r√©sidus ind√©pendants (p-value de 0.2519), ce qui sugg√®re qu'il est mieux adapt√© pour cette s√©rie de temp√©rature. Par cons√©quent, **Holt-Winters additive** semble √™tre le mod√®le le plus robuste et pr√©cis pour cette √©tude(realtive √† comparer avec prophet), malgr√© un ajustement global l√©g√®rement moins favorable en termes d'AIC et BIC.

ANNEXE:

# 7) Pr√©vision avec prophet de facebook

```{r echo=FALSE, warning=FALSE, message=FALSE}
#install.packages("prophet")

# üîπ Pr√©parer les donn√©es pour Prophet (colonnes : ds = date, y = temp√©rature)
df_prophet <- fich %>%
  select(ds = Dates, y = Temperature)

# üîπ Entra√Æner le mod√®le Prophet
m <- prophet(df_prophet)

# üîπ Cr√©er un futur DataFrame pour pr√©dire 10 ans (120 mois)
future <- make_future_dataframe(m, periods = 120, freq = "month")

# üîπ Pr√©visions
forecast <- predict(m, future)
summary(forecast)
# üîπ  avec les donn√©es historiques
df_forecast <- forecast %>%
  select(ds, yhat, yhat_lower, yhat_upper) %>%
  rename(Date = ds,
         Pr√©vision = yhat,
         IC_min = yhat_lower,
         IC_max = yhat_upper)

# üîπ Joindre avec les vraies valeurs (Temp√©rature observ√©e)
df_final <- df_forecast %>%
  left_join(df_prophet, by = c("Date" = "ds")) %>%
  rename(Temp√©rature_Observ√©e = y)


# üîπ Tracer les pr√©visions de Prophet
ggplot(df_final, aes(x = Date)) +
  geom_line(aes(y = Temp√©rature_Observ√©e), color = "black", size = 0.8, alpha = 0.5) +  # Temp√©rature observ√©e
  geom_line(aes(y = Pr√©vision), color = "blue", size = 1) +  # Pr√©vision Prophet
  geom_ribbon(aes(ymin = IC_min, ymax = IC_max), fill = "blue", alpha = 0.2) +  # Intervalles de confiance
  labs(title = "Pr√©visions de Temp√©rature avec Prophet",
       x = "Date", y = "Temp√©rature") +
  theme_minimal()

# üîπ Sauvegarder pour Power BI
write_csv(df_final, "previsions_prophet.csv")
write_xlsx(df_final, "previsions_prophet.xlsx")


# üîπ Calcul des r√©sidus de Prophet
df_residus <- data.frame(
  Date = df_final$Date,
  R√©sidus = df_final$Temp√©rature_Observ√©e - df_final$Pr√©vision
)

# üîπ Tracer les r√©sidus
ggplot(df_residus, aes(x = Date, y = R√©sidus)) +
  geom_line() +
  ggtitle("R√©sidus de la pr√©vision Prophet") +
  xlab("Date") +
  ylab("R√©sidus") +
  theme_minimal()


```

nous avons utilis√© le mod√®le Prophet pour pr√©voir l'√©volution des temp√©ratures mensuelles entre 1970 et 2023. Ce mod√®le de d√©composition permet de s√©parer la s√©rie en plusieurs composantes, notamment la tendance, la saisonnalit√© annuelle et les termes additifs, ce qui nous permet d'examiner en d√©tail le comportement de la temp√©rature au fil du temps.

**Comportement de la tendance**\
La composante de tendance montre une stabilit√© g√©n√©rale, avec une l√©g√®re croissance des temp√©ratures au fil des ann√©es. La temp√©rature moyenne reste proche de 11,2¬∞C en d√©but de p√©riode, mais atteint 11,58¬∞C en fin de p√©riode. Ce l√©ger r√©chauffement sugg√®re que la tendance globale est en accord avec les observations r√©centes concernant le r√©chauffement climatique.

**Saisonnalit√© annuelle**\
Le mod√®le capte une saisonnalit√© annuelle marqu√©e, avec des temp√©ratures plus froides en hiver et plus chaudes en √©t√©. La variation annuelle est bien repr√©sent√©e, oscillant entre -7,87¬∞C et +8,5¬∞C autour de la tendance. Ce comportement saisonnier est parfaitement adapt√© aux donn√©es mensuelles, et la d√©tection automatique de la saisonnalit√© annuelle par Prophet est un point fort du mod√®le.

**Composantes additives**\
Le mod√®le a utilis√© uniquement des termes additifs pour capturer la saisonnalit√©, ce qui est logique pour des donn√©es mensuelles de temp√©ratures. L'absence d'effet multiplicatif montre que les variations saisonni√®res sont suffisamment bien captur√©es par les termes additifs, ce qui renforce la robustesse de la mod√©lisation.

**Incertitude et intervalles de confiance**\
Les pr√©visions du mod√®le sont accompagn√©es d'intervalles de confiance relativement √©troits, ce qui indique une certaine stabilit√© et fiabilit√© dans les pr√©dictions. Cette caract√©ristique de Prophet nous permet de faire confiance √† la solidit√© des pr√©visions √† long terme.

En conclusion, Prophet s'av√®re √™tre un mod√®le fiable pour analyser les s√©ries temporelles de temp√©ratures mensuelles. Les r√©sultats montrent une tendance l√©g√®rement croissante des temp√©ratures, une forte saisonnalit√© annuelle bien capt√©e, et une bonne pr√©cision dans les pr√©visions. Les intervalles de confiance √©troits indiquent une bonne stabilit√© du mod√®le. Ce mod√®le est donc particuli√®rement adapt√© √† ce type d'analyse climatique.

### Comparaison avec Holt

Le mod√®le **Prophet** et le mod√®le **Holt-Winters additif** pr√©sentent des performances distinctes pour la pr√©vision des temp√©ratures mensuelles de 1970 √† 2013. Prophet capture une tendance l√©g√®rement croissante, indiquant un r√©chauffement climatique, et g√®re efficacement la saisonnalit√© annuelle avec une amplitude √©lev√©e. En revanche, Holt-Winters montre une tendance l√©g√®rement n√©gative et une saisonnalit√© moins marqu√©e. Les pr√©visions de Prophet sont accompagn√©es de petits intervalles de confiance, ce qui en fait un mod√®le plus stable et fiable pour des pr√©visions √† long terme. Holt-Winters, bien qu‚Äôefficace avec un RMSE de 1,4¬∞C et un MAPE d‚Äôenviron 20 %, est moins r√©actif aux variations √† court terme en raison de ses param√®tres de lissage faibles. Prophet semble ainsi mieux adapt√© pour capturer les tendances globales et les fluctuations complexes sur une longue p√©riode, tandis que Holt-Winters est plus stable mais moins sensible aux changements non lin√©aires. En termes de performance, Prophet est plus pr√©cis pour les pr√©visions sur de longues p√©riodes, tandis que Holt-Winters offre un ajustement plus simple mais robuste √† court terme.

# 8) Conclusion

L'analyse de l'√©volution des temp√©ratures en France de 1970 √† 2013, √† travers les mod√®les Prophet, Holt-Winters et ARIMA, a permis d'identifier plusieurs tendances int√©ressantes. Au cours des premi√®res d√©cennies, la tendance des temp√©ratures √©tait relativement stable, avec des fluctuations saisonni√®res marqu√©es mais sans variation significative √† long terme. Cependant, plus r√©cemment, les mod√®les ont mis en √©vidence une l√©g√®re hausse des temp√©ratures, avec une moyenne qui passe de 11,2¬∞C √† 11,58¬∞C, sugg√©rant un r√©chauffement progressif. Prophet a bien captur√© cette l√©g√®re croissance, tout en g√©rant efficacement la saisonnalit√© et les tendances non lin√©aires. Holt-Winters a aussi d√©tect√© cette tendance, bien que de mani√®re plus conservatrice, et a bien mod√©lis√© la saisonnalit√© avec des hivers plus froids et des √©t√©s plus chauds. Le mod√®le ARIMA, tout en √©tant utile pour saisir les variations pass√©es, n'a pas capt√© aussi pr√©cis√©ment les tendances non lin√©aires que Prophet. Globalement, ces r√©sultats indiquent qu'apr√®s une p√©riode de stabilit√© , les temp√©ratures en France connaissent une l√©g√®re augmentation, ce qui pourrait √™tre un signe de r√©chauffement climatique(on est d√©ja deans). Ces observations soulignent l'importance de continuer √† surveiller ces √©volutions et de recourir √† des mod√®les adapt√©s pour mieux anticiper les impacts futurs du changement climatique.
